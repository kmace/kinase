---
title: "Residual Clustering"
output: html_notebook
---

The residuals for single genes seem to tell a story of context dependent regulation. Lets boost the certintaty of these hypothesese by seeing if residual patturns are conserved in clusters.
```{r}
load('input/images/paper_data.RData')
library(WGCNA)
library(caret)
expr = t(full_std_resid_matrix)
library(dplyr)
library(tidyr)

datTraits = tibble(Experiment = rownames(expr)) %>% separate(Experiment, c('Condition', 'Strain'), '_')

```

Now we know from previous analyis, that the standardized residuals are normally distributed with mean = 0 and sd = 1.

Lets therefore take residuals that are less than 2 standard deviations and reduce them to zero.

```{r}
expr[abs(expr)<2] = 0
datExpr = expr
```

Lets also throw out bad samples:
